<%= content_for(:title) { @pipeline.name_in_database } %>
<%= content_for(:header) do %>
  <%= render "shared/breadcrumb_nav" %>

  <div class='float-start'>
    <h1><%= @pipeline.name %></h1>
    <p><%= @pipeline.description %></p>
  </div>

  <div class='clearfix'></div>

  <div class='mt-4'></div>
  <ul class="nav nav-tabs">
    <li class='nav-item'>
      <%= link_to "Pipeline", pipeline_path(@pipeline), class: "nav-link" %>
    </li>

    <li class='nav-item'>
      <%= link_to "Jobs", pipeline_pipeline_job_path(@pipeline, @pipeline.pipeline_jobs.last), class: "nav-link active" %>
    </li>
  </ul>
<% end %>

<%- @pipeline_job.reports.each do |report| %>

  <div class='card p-4 definition-group--spacer'>

    <div class='d-flex'>
      <div class='me-auto'>
        <h4 class='mb-4'><%= report.harvest_definition.source_id %> </h4>
      </div>
    </div>

    <div class='row'>
      <div class='col-3'>
        <div class='card'>
          <div class='card-body'>
            <h5 class='card-title'>Extraction</h5>

            <p><%= report.pages_extracted %> pages</p>
          </div>

          <i class='bi bi-arrow-right card__right-arrow'></i>
        </div>
      </div>

      <div class='col-3'>
        <div class='card'>
          <div class='card-body'>
            <h5 class='card-title'>Transformation</h5>

            <p><%= report.records_transformed %> records</p>
          </div>

          <i class='bi bi-arrow-right card__right-arrow'></i>
        </div>
      </div>
      
      <div class='col-3'>
        <div class='card'>
          <div class='card-body'>
            <h5 class='card-title'>Load</h5>

            <p><%= report.records_loaded %> records</p>
          </div>

          <i class='bi bi-arrow-right card__right-arrow'></i>
        </div>
      </div>
      
      <div class='col-3'>
        <div class='card'>
          <div class='card-body'>
            <h5 class='card-title'>Delete/Reject</h5>

            <p><%= report.records_deleted %> deleted | <%= report.records_rejected %> rejected</p>
          </div>

        </div>
      </div>
    </div>
  </div> 


<% end %>
